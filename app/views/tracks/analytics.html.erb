<%= render 'time_filter' %>

<h1>Analytics</h1>

<% @tracks.each do |track| %>
<div class="well">
  <div class="row header-row">
    <h1><%= track.name %></h1>
  </div>
  <% track.checkpoints.order(id: :asc).each do |checkpoint| %>
    <div class="row">
      <div class="col-md-9">
        <h4>
        <%= checkpoint.content %>
        </h4>
        <%= render partial: 'progress_bar', locals: { checkpoint: checkpoint } %>
      </div>

      <% ratings_count = checkpoint.ratings_count(@start_time, @end_time) %>
      <div class="col-md-3 ratings-count">
        <div class= "count-number"><%= ratings_count %></div>
        <p><%="response".pluralize(ratings_count) %></p>
      </div>
    </div>
  <% end %>
</div>

<% end %>


<h2>Average rating over class (example: first track)</h2>
<div class="row">
  <%= content_tag :div, "", id: "tracks_chart", data: {ratings: ratings_data} %>
</div>
